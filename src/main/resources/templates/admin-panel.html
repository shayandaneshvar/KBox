<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/">
<!--xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5"-->
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
          crossorigin="anonymous">
    <title>Admin Dashboard</title>
</head>
<style>
    .user, .general-info {
        display: flex;
        justify-content: center;
        justify-items: center;
        padding: 1rem;
    }

    .info {
        padding-left: 1.5rem;
        padding-right: 1.5rem;
    }
</style>
<script>
    function deleteUser(id, currentSessionID) {
        const xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
            console.log("changed")
            console.log(this.status)
            location.reload()
        };
        xhr.open("DELETE", window.location.href + "/admin/" + id + "?sessionId=" + currentSessionID, true);
        xhr.send();
    }

</script>
<body>
<p th:text="${sessionId}">SESSION ID</p>
<div th:each="user:${usersList}">

    <div class="user-container">
        <hr>
        <div class="user">
            <div class="general-info">
                <div class="info" th:text="${user.id}">someId</div>
                <div class="info" th:text="${user.firstname}">John</div>
                <div class="info" th:text="${user.lastname}">Doe</div>
                <div class="info" th:text="${user.email}">Email@example.com
                </div>
                <div class="info" th:text="${user.creationDate}">2020-2-12</div>
            </div>
            <div class="functionalities">
                <button type="button" class="button btn btn-success">Change
                    Password
                </button>
                <button type="button" class="button btn btn-danger"
                        th:attr="onclick=|deleteUser('${user.id}','${sessionId}')|">
                    Delete
                </button>
            </div>
        </div>
        <hr>
    </div>


</div>
</body>
</html>
